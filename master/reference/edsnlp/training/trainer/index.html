<!DOCTYPE html>

<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><link href="../optimizer/" rel="prev"/><link href="../../tune/" rel="next"/><link href="../../../../assets/logo/edsnlp.svg" rel="icon"/><meta content="mkdocs-1.6.1, mkdocs-material-9.7.1" name="generator"/><title>trainer - EDS-NLP</title><link href="../../../../assets/stylesheets/main.484c7ddc.min.css" rel="stylesheet"/><link href="../../../../assets/stylesheets/palette.ab4e12ef.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../../../../assets/_mkdocstrings.css" rel="stylesheet"/><link href="../../../../override.css" rel="stylesheet"/><link href="../../../../assets/stylesheets/extra.css" rel="stylesheet"/><link href="../../../../clickable-code.css" rel="stylesheet"/><link href="../../../../cards.css" rel="stylesheet"/><link href="../../../../pret.css" rel="stylesheet"/><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#edsnlptrainingtrainer"> Skip to content </a> </div> <div data-md-component="announce"> <aside class="md-banner"> <div class="md-banner__inner md-grid md-typeset"> <button aria-label="Don't show this again" class="md-banner__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> Check out the new <a href="../../../../tutorials/training-span-classifier">span classifier training tutorial</a> and the <a href="../../../../tutorials/hpc">Slurm tutorial</a> ! </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <div data-md-color-scheme="default" data-md-component="outdated" hidden=""> </div> <header class="md-header md-header--shadow" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="EDS-NLP" class="md-header__button md-logo" data-md-component="logo" href="../../../.." title="EDS-NLP"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> EDS-NLP </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> trainer </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0"> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a class="md-source" data-md-component="source" href="https://github.com/aphp/edsnlp" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> aphp/edsnlp </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="EDS-NLP" class="md-nav__button md-logo" data-md-component="logo" href="../../../.." title="EDS-NLP"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg> </a> EDS-NLP </label> <div class="md-nav__source"> <a class="md-source" data-md-component="source" href="https://github.com/aphp/edsnlp" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class="md-source__repository"> aphp/edsnlp </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../.."> <span class="md-ellipsis"> Getting started </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="https://aphp.github.io/edsnlp/demo" target="_blank"> <span class="md-ellipsis"> Demo </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../tutorials/"> <span class="md-ellipsis"> Tutorials </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../pipes/"> <span class="md-ellipsis"> Pipes </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../../tokenizers/"> <span class="md-ellipsis"> Tokenizers </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../data/"> <span class="md-ellipsis"> Data Connectors </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../training/training-api/"> <span class="md-ellipsis"> Training </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../concepts/pipeline/"> <span class="md-ellipsis"> Concepts </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../metrics/"> <span class="md-ellipsis"> Metrics </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../utilities/"> <span class="md-ellipsis"> Utilities </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/> <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0"> <span class="md-ellipsis"> Code Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="true" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> Code Reference </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_11_1" type="checkbox"/> <div class="md-nav__link md-nav__container"> <a class="md-nav__link" href="../../"> <span class="md-ellipsis"> edsnlp </span> </a> <label class="md-nav__link" for="__nav_11_1" id="__nav_11_1_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded="true" aria-labelledby="__nav_11_1_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_11_1"> <span class="md-nav__icon md-icon"></span> edsnlp </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../connectors/"> <span class="md-ellipsis"> connectors </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../core/"> <span class="md-ellipsis"> core </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../data/"> <span class="md-ellipsis"> data </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../evaluate/"> <span class="md-ellipsis"> evaluate </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../extensions/"> <span class="md-ellipsis"> extensions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../language/"> <span class="md-ellipsis"> language </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../matchers/"> <span class="md-ellipsis"> matchers </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../metrics/"> <span class="md-ellipsis"> metrics </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../package/"> <span class="md-ellipsis"> package </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../patch_spacy/"> <span class="md-ellipsis"> patch_spacy </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../pipes/"> <span class="md-ellipsis"> pipes </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../processing/"> <span class="md-ellipsis"> processing </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../reducers/"> <span class="md-ellipsis"> reducers </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../train/"> <span class="md-ellipsis"> train </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_11_1_17" type="checkbox"/> <div class="md-nav__link md-nav__container"> <a class="md-nav__link" href="../"> <span class="md-ellipsis"> training </span> </a> <label class="md-nav__link" for="__nav_11_1_17" id="__nav_11_1_17_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded="true" aria-labelledby="__nav_11_1_17_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_11_1_17"> <span class="md-nav__icon md-icon"></span> training </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../loggers/"> <span class="md-ellipsis"> loggers </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../optimizer/"> <span class="md-ellipsis"> optimizer </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> trainer </span> <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> trainer </span> </a> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.GenericScorer"> <span class="md-ellipsis"> GenericScorer </span> </a> <nav aria-label="GenericScorer" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.GenericScorer--parameters"> <span class="md-ellipsis"> Parameters </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.TrainingData"> <span class="md-ellipsis"> TrainingData </span> </a> <nav aria-label="TrainingData" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.TrainingData--parameters"> <span class="md-ellipsis"> Parameters </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.train"> <span class="md-ellipsis"> train() </span> </a> <nav aria-label="train()" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.train--parameters"> <span class="md-ellipsis"> Parameters </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tune/"> <span class="md-ellipsis"> tune </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../utils/"> <span class="md-ellipsis"> utils </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../viz/"> <span class="md-ellipsis"> viz </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../../contributing/"> <span class="md-ellipsis"> Contributing to EDS-NLP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../../changelog/"> <span class="md-ellipsis"> Changelog </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.GenericScorer"> <span class="md-ellipsis"> GenericScorer </span> </a> <nav aria-label="GenericScorer" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.GenericScorer--parameters"> <span class="md-ellipsis"> Parameters </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.TrainingData"> <span class="md-ellipsis"> TrainingData </span> </a> <nav aria-label="TrainingData" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.TrainingData--parameters"> <span class="md-ellipsis"> Parameters </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.train"> <span class="md-ellipsis"> train() </span> </a> <nav aria-label="train()" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#edsnlp.training.trainer.train--parameters"> <span class="md-ellipsis"> Parameters </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1 id="edsnlptrainingtrainer"><code>edsnlp.training.trainer</code></h1> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" id="edsnlp.training.trainer.GenericScorer"> <code class="highlight language-python"><span class="n">GenericScorer</span></code> </h2> <div class="doc doc-contents"> <p>A scorer to evaluate the model performance on various tasks.</p> <h3 id="edsnlp.training.trainer.GenericScorer--parameters">Parameters</h3> <table> <thead> <tr> <th><b>PARAMETER</b></th> <th><b>DESCRIPTION</b></th> </tr> </thead> <tbody> <tr> <td><code>batch_size</code></td> <td class="doc-param-details"> <p>The batch size to use for scoring. Can be an int (number of documents) or a string (batching expression like "2000 words").</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>1</code> </span> </p> </td> </tr> <tr> <td><code>speed</code></td> <td class="doc-param-details"> <p>Whether to compute the model speed (words/documents per second)</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="bool">bool</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> <tr> <td><code>autocast</code></td> <td class="doc-param-details"> <p>Whether to use autocasting for mixed precision during the evaluation, defaults to True.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Union">Union</span>[<span title="bool">bool</span>, <span title="typing.Any">Any</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>metrics</code></td> <td class="doc-param-details"> <p>A keyword arguments mapping of metric names to metrics objects. See the <a href="../../../../metrics">metrics</a> documentation for more info.</p> <p> <span class="doc-param-default"> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <div class="doc doc-children"> </div> </div> </div><div class="doc doc-object doc-class"> <h2 class="doc doc-heading" id="edsnlp.training.trainer.TrainingData"> <code class="highlight language-python"><span class="n">TrainingData</span></code> </h2> <div class="doc doc-contents"> <p>A training data object.</p> <h3 id="edsnlp.training.trainer.TrainingData--parameters">Parameters</h3> <table> <thead> <tr> <th><b>PARAMETER</b></th> <th><b>DESCRIPTION</b></th> </tr> </thead> <tbody> <tr> <td><code>data</code></td> <td class="doc-param-details"> <p>The stream of documents to train on. The documents will be preprocessed and collated according to the pipeline's components.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-internal" href="../../../../concepts/inference/#edsnlp.core.stream.Stream" title="Streams (edsnlp.core.stream.Stream)">Stream</a></code> </span> </p> </td> </tr> <tr> <td><code>batch_size</code></td> <td class="doc-param-details"> <p>The batch size. Can be a batching expression like "2000 words", an int (number of documents), or a tuple (batch_size, batch_by). The batch_by argument should be a statistic produced by the pipes that will be trained. For instance, the <code><a href="../../../../pipes/trainable/embeddings/span_pooler/#edsnlp.pipes.trainable.embeddings.span_pooler.factory.create_component">eds.span_pooler</a></code> component produces a "spans" statistic, that can be used to produce batches of no more than 16 spans by setting batch_size to "16 spans".</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-internal" href="../../utils/batching/#edsnlp.utils.batching.BatchSizeArg" title="BatchSizeArg (edsnlp.utils.batching.BatchSizeArg)">BatchSizeArg</a></code> </span> </p> </td> </tr> <tr> <td><code>shuffle</code></td> <td class="doc-param-details"> <p>The shuffle strategy. Can be "dataset" to shuffle the entire dataset (this can be memory-intensive for large file based datasets), "fragment" to shuffle the fragment-based datasets like parquet files, or a batching expression like "2000 words" to shuffle the dataset in chunks of 2000 words.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing_extensions.Literal">Literal</span>[False]]</code> </span> </p> </td> </tr> <tr> <td><code>sub_batch_size</code></td> <td class="doc-param-details"> <p>How to split each batch into sub-batches that will be fed to the model independently to accumulate gradients over. To split a batch of 8000 tokens into smaller batches of 1000 tokens each, just set this to "1000 tokens".</p> <p>You can also request a number of splits, like "4 splits", to split the batch into N parts each close to (but less than) batch_size / N.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" href="../../utils/batching/#edsnlp.utils.batching.BatchSizeArg" title="BatchSizeArg (edsnlp.utils.batching.BatchSizeArg)">BatchSizeArg</a>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>pipe_names</code></td> <td class="doc-param-details"> <p>The names of the pipes that should be trained on this data. If None, defaults to all trainable pipes.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<span title="edsnlp.utils.typing.AsList">AsList</span>[<span title="str">str</span>]]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>post_init</code></td> <td class="doc-param-details"> <p>Whether to call the pipeline's post_init method with the data before training.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="bool">bool</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> </tbody> </table> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 class="doc doc-heading" id="edsnlp.training.trainer.train"> <code class="highlight language-python"><span class="n">train</span></code> </h2> <div class="doc doc-contents"> <p>Train a pipeline.</p> <h3 id="edsnlp.training.trainer.train--parameters">Parameters</h3> <table> <thead> <tr> <th><b>PARAMETER</b></th> <th><b>DESCRIPTION</b></th> </tr> </thead> <tbody> <tr> <td><code>nlp</code></td> <td class="doc-param-details"> <p>The pipeline that will be trained in place.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-internal" href="../../core/pipeline/#edsnlp.core.pipeline.Pipeline" title="Pipeline (edsnlp.Pipeline)">Pipeline</a></code> </span> </p> </td> </tr> <tr> <td><code>train_data</code></td> <td class="doc-param-details"> <p>The training data. Can be a single <a class="autorefs autorefs-internal" href="#edsnlp.training.trainer.TrainingData" title="TrainingData">TrainingData</a> object, a dict that will be cast or a list of these objects.</p> <details class="note"> <summary><code>TrainingData</code> object/dictionary</summary> <div class="doc doc-object doc-class"> <table> <thead> <tr> <th><b>PARAMETER</b></th> <th><b>DESCRIPTION</b></th> </tr> </thead> <tbody> <tr> <td><code>data</code></td> <td class="doc-param-details"> <p>The stream of documents to train on. The documents will be preprocessed and collated according to the pipeline's components.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-internal" href="../../../../concepts/inference/#edsnlp.core.stream.Stream" title="Streams (edsnlp.core.stream.Stream)">Stream</a></code> </span> </p> </td> </tr> <tr> <td><code>batch_size</code></td> <td class="doc-param-details"> <p>The batch size. Can be a batching expression like "2000 words", an int (number of documents), or a tuple (batch_size, batch_by). The batch_by argument should be a statistic produced by the pipes that will be trained. For instance, the <code><a href="../../../../pipes/trainable/embeddings/span_pooler/#edsnlp.pipes.trainable.embeddings.span_pooler.factory.create_component">eds.span_pooler</a></code> component produces a "spans" statistic, that can be used to produce batches of no more than 16 spans by setting batch_size to "16 spans".</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-internal" href="../../utils/batching/#edsnlp.utils.batching.BatchSizeArg" title="BatchSizeArg (edsnlp.utils.batching.BatchSizeArg)">BatchSizeArg</a></code> </span> </p> </td> </tr> <tr> <td><code>shuffle</code></td> <td class="doc-param-details"> <p>The shuffle strategy. Can be "dataset" to shuffle the entire dataset (this can be memory-intensive for large file based datasets), "fragment" to shuffle the fragment-based datasets like parquet files, or a batching expression like "2000 words" to shuffle the dataset in chunks of 2000 words.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing_extensions.Literal">Literal</span>[False]]</code> </span> </p> </td> </tr> <tr> <td><code>sub_batch_size</code></td> <td class="doc-param-details"> <p>How to split each batch into sub-batches that will be fed to the model independently to accumulate gradients over. To split a batch of 8000 tokens into smaller batches of 1000 tokens each, just set this to "1000 tokens".</p> <p>You can also request a number of splits, like "4 splits", to split the batch into N parts each close to (but less than) batch_size / N.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" href="../../utils/batching/#edsnlp.utils.batching.BatchSizeArg" title="BatchSizeArg (edsnlp.utils.batching.BatchSizeArg)">BatchSizeArg</a>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>pipe_names</code></td> <td class="doc-param-details"> <p>The names of the pipes that should be trained on this data. If None, defaults to all trainable pipes.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<span title="edsnlp.utils.typing.AsList">AsList</span>[<span title="str">str</span>]]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>post_init</code></td> <td class="doc-param-details"> <p>Whether to call the pipeline's post_init method with the data before training.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="bool">bool</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> </tbody> </table> </div></details> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="edsnlp.utils.typing.AsList">AsList</span>[<a class="autorefs autorefs-internal" href="#edsnlp.training.trainer.TrainingData" title="TrainingData (edsnlp.training.trainer.TrainingData)">TrainingData</a>]</code> </span> </p> </td> </tr> <tr> <td><code>val_data</code></td> <td class="doc-param-details"> <p>The validation data. Can be a single Stream object or a list of Stream.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="edsnlp.utils.typing.AsList">AsList</span>[<a class="autorefs autorefs-internal" href="../../../../concepts/inference/#edsnlp.core.stream.Stream" title="Streams (edsnlp.core.stream.Stream)">Stream</a>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>[]</code> </span> </p> </td> </tr> <tr> <td><code>seed</code></td> <td class="doc-param-details"> <p>The random seed</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="int">int</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>42</code> </span> </p> </td> </tr> <tr> <td><code>max_steps</code></td> <td class="doc-param-details"> <p>The maximum number of training steps</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="int">int</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>1000</code> </span> </p> </td> </tr> <tr> <td><code>optimizer</code></td> <td class="doc-param-details"> <p>The optimizer. If None, a default optimizer will be used.</p> <details class="note"> <summary><code>ScheduledOptimizer</code> object/dictionary</summary> <div class="doc doc-object doc-class"> <table> <thead> <tr> <th><b>PARAMETER</b></th> <th><b>DESCRIPTION</b></th> </tr> </thead> <tbody> <tr> <td><code>optim</code></td> <td class="doc-param-details"> <p>The optimizer to use. If a string (like "adamw") or a type to instantiate, the <code>module</code> and <code>groups</code> must be provided.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="typing.Type">Type</span>[<span title="torch.optim.Optimizer">Optimizer</span>], <span title="torch.optim.Optimizer">Optimizer</span>]</code> </span> </p> </td> </tr> <tr> <td><code>module</code></td> <td class="doc-param-details"> <p>The module to optimize. Usually the <code>nlp</code> pipeline object.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="edsnlp.core.PipelineProtocol">PipelineProtocol</span>, <span title="torch.nn.Module">Module</span>]]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>total_steps</code></td> <td class="doc-param-details"> <p>The total number of steps, used for schedules.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>groups</code></td> <td class="doc-param-details"> <p>The groups to optimize. Each group is a dictionary containing:</p> <ul> <li>a regex <code>selector</code> key to match the parameter of that group by their names (as listed by <code>nlp.named_parameters()</code>)</li> <li>and several other keys that define the optimizer parameters for that group, such as <code>lr</code>, <code>weight_decay</code> etc. The value for these keys can be a <code>Schedule</code> instance or a simple value</li> <li>an <code>exclude</code> key that can be set to True to exclude parameters</li> </ul> <p>The matching is performed by running <code>regex.search(selector, name)</code> so you do not have to match the full name. Note that the order of the groups matters. If a parameter name matches multiple selectors, the configurations of these selectors are combined in reverse order (from the last matched selector to the first), allowing later selectors to complete options from earlier ones. If a selector contains <code>exclude=True</code>, any parameter matching it is excluded from optimization.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[<span title="Group">Group</span>]]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> </div></details> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-external" href="https://aphp.github.io/confit/latest/reference/draft/#confit.draft.Draft" title="confit.Draft">Draft</a>[<a class="autorefs autorefs-internal" href="../optimizer/#edsnlp.training.optimizer.ScheduledOptimizer" title="ScheduledOptimizer (edsnlp.training.optimizer.ScheduledOptimizer)">ScheduledOptimizer</a>], <a class="autorefs autorefs-internal" href="../optimizer/#edsnlp.training.optimizer.ScheduledOptimizer" title="ScheduledOptimizer (edsnlp.training.optimizer.ScheduledOptimizer)">ScheduledOptimizer</a>, <span title="torch.optim.Optimizer">Optimizer</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>validation_interval</code></td> <td class="doc-param-details"> <p>The number of steps between each evaluation. Defaults to 1/10 of max_steps</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>checkpoint_interval</code></td> <td class="doc-param-details"> <p>The number of steps between each model save. Defaults to validation_interval</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>grad_max_norm</code></td> <td class="doc-param-details"> <p>The maximum gradient norm</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="float">float</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>5.0</code> </span> </p> </td> </tr> <tr> <td><code>grad_dev_policy</code></td> <td class="doc-param-details"> <p>The policy to apply when a gradient spike is detected, ie. when the gradient norm is higher than the mean + std * grad_max_dev. Can be:</p> <ul> <li>"clip_mean": clip the gradients to the mean gradient norm</li> <li>"clip_threshold": clip the gradients to the mean + std * grad_max_dev</li> <li>"skip": skip the step</li> </ul> <p>These do not apply to <code>grad_max_norm</code> that is always enforced when it is not None, since <code>grad_max_norm</code> is not adaptive and would most likely prohibit the model from learning during the early stages of training when gradients are expected to be high.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<span title="typing_extensions.Literal">Literal</span>['clip_mean', 'clip_threshold', 'skip']]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>grad_ewm_window</code></td> <td class="doc-param-details"> <p>Approximately how many steps should we look back to compute the average gradient norm and variance to detect gradient deviation spikes.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="int">int</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>100</code> </span> </p> </td> </tr> <tr> <td><code>grad_max_dev</code></td> <td class="doc-param-details"> <p>The threshold to apply to detect gradient spikes. A spike is detected when the value is higher than the mean + variance * threshold.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="float">float</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>7.0</code> </span> </p> </td> </tr> <tr> <td><code>loss_scales</code></td> <td class="doc-param-details"> <p>The loss scales for each component (useful for multi-task learning)</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="float">float</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> <tr> <td><code>scorer</code></td> <td class="doc-param-details"> <p>How to score the model. Expects a <code>GenericScorer</code> object or a dict containing a mapping of metric names to metric objects.</p> <details class="note"> <summary><code>GenericScorer</code> object/dictionary</summary> <div class="doc doc-object doc-class"> <table> <thead> <tr> <th><b>PARAMETER</b></th> <th><b>DESCRIPTION</b></th> </tr> </thead> <tbody> <tr> <td><code>batch_size</code></td> <td class="doc-param-details"> <p>The batch size to use for scoring. Can be an int (number of documents) or a string (batching expression like "2000 words").</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>1</code> </span> </p> </td> </tr> <tr> <td><code>speed</code></td> <td class="doc-param-details"> <p>Whether to compute the model speed (words/documents per second)</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="bool">bool</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> <tr> <td><code>autocast</code></td> <td class="doc-param-details"> <p>Whether to use autocasting for mixed precision during the evaluation, defaults to True.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Union">Union</span>[<span title="bool">bool</span>, <span title="typing.Any">Any</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>metrics</code></td> <td class="doc-param-details"> <p>A keyword arguments mapping of metric names to metrics objects. See the <a href="../../../../metrics">metrics</a> documentation for more info.</p> <p> <span class="doc-param-default"> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> </div></details> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-internal" href="#edsnlp.training.trainer.GenericScorer" title="GenericScorer (edsnlp.training.trainer.GenericScorer)">GenericScorer</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code><a class="autorefs autorefs-internal" href="#edsnlp.training.trainer.GenericScorer" title="GenericScorer (edsnlp.training.trainer.GenericScorer)">GenericScorer</a>()</code> </span> </p> </td> </tr> <tr> <td><code>num_workers</code></td> <td class="doc-param-details"> <p>The number of workers to use for preprocessing the data in parallel. Setting it to 0 means no parallelization : data is processed on the main thread which may induce latency slow down the training. To avoid this, a good practice consist in doing the preprocessing either before training or in parallel in a separate process. Because of how EDS-NLP handles stream multiprocessing, changing this value will affect the order of the documents in the produces batches. A stream [1, 2, 3, 4, 5, 6] split in batches of size 3 will produce:</p> <ul> <li>[1, 2, 3] and [4, 5, 6] with 1 worker</li> <li>[1, 3, 5] and [2, 4, 6] with 2 workers</li> </ul> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="int">int</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>0</code> </span> </p> </td> </tr> <tr> <td><code>cpu</code></td> <td class="doc-param-details"> <p>Whether to use force training on CPU. On MacOS, this might be necessary to get around some <code>mps</code> backend issues.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="bool">bool</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr> <td><code>mixed_precision</code></td> <td class="doc-param-details"> <p>The mixed precision mode. Can be "no", "fp16", "bf16" or "fp8".</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing_extensions.Literal">Literal</span>['no', 'fp16', 'bf16', 'fp8']</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'no'</code> </span> </p> </td> </tr> <tr> <td><code>output_dir</code></td> <td class="doc-param-details"> <p>The output directory, which will contain a <code>model-last</code> directory with the last model, and a <code>train_metrics.json</code> file with the training metrics and stats.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="str">str</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code><span title="pathlib.Path">Path</span>('artifacts')</code> </span> </p> </td> </tr> <tr> <td><code>output_model_dir</code></td> <td class="doc-param-details"> <p>The directory where to save the model. If None, defaults to <code>output_dir / "model-last"</code>.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="pathlib.Path">Path</span>, <span title="str">str</span>]]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>save_model</code></td> <td class="doc-param-details"> <p>Whether to save the model or not. This can be useful if you are only interested in the metrics, but no the model, and want to avoid spending time dumping the model weights to the disk.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="bool">bool</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> <tr> <td><code>logger</code></td> <td class="doc-param-details"> <p>The logger to use. Can be a boolean to use the default loggers (rich and json), a list of logger names, or a list of logger objects.</p> <p>You can use huggingface accelerate integrated loggers (<code>tensorboard</code>, <code>wandb</code>, <code>comet_ml</code>, <code>aim</code>, <code>mlflow</code>, <code>clearml</code>, <code>dvclive</code>), or EDS-NLP simple loggers, or a combination of both:</p> <ul> <li><code>csv</code>: logs to a CSV file in <code>output_dir</code> (<code>artifacts/metrics.csv</code>)</li> <li><code>json</code>: logs to a JSON file in <code>output_dir</code> (<code>artifacts/metrics.json</code>)</li> <li><code>rich</code>: logs to a rich table in the terminal</li> </ul> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Union">Union</span>[<span title="bool">bool</span>, <span title="edsnlp.utils.typing.AsList">AsList</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="accelerate.tracking.GeneralTracker">GeneralTracker</span>, <a class="autorefs autorefs-external" href="https://aphp.github.io/confit/latest/reference/draft/#confit.draft.Draft" title="confit.Draft">Draft</a>[<span title="accelerate.tracking.GeneralTracker">GeneralTracker</span>]]]]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> <tr> <td><code>log_weight_grads</code></td> <td class="doc-param-details"> <p>Whether to log the weight gradients during training.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="bool">bool</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr> <td><code>on_validation_callback</code></td> <td class="doc-param-details"> <p>A callback function invoked during validation steps to handle custom logic.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<span title="typing.Callable">Callable</span>[[<span title="typing.Dict">Dict</span>], None]]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>project_name</code></td> <td class="doc-param-details"> <p>The project name, used to group experiments in some loggers. If None, defaults to the path of the config file, relative to the home directory, with slashes replaced by double underscores.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="str">str</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>kwargs</code></td> <td class="doc-param-details"> <p>Additional keyword arguments.</p> <p> <span class="doc-param-default"> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class="doc-section-title">RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <span class="doc-returns-annotation"> <code><a class="autorefs autorefs-internal" href="../../core/pipeline/#edsnlp.core.pipeline.Pipeline" title="Pipeline (edsnlp.Pipeline)">Pipeline</a></code> </span> </td> <td class="doc-returns-details"> <div class="doc-md-description"> <p>The trained pipeline</p> </div> </td> </tr> </tbody> </table> </div> </div> </div> </div> </div> <div class="footnote"><hr/><ol></ol></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component="top" hidden="" type="button"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: optimizer" class="md-footer__link md-footer__link--prev" href="../optimizer/"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </div> <div class="md-footer__title"> <span class="md-footer__direction"> Previous </span> <div class="md-ellipsis"> optimizer </div> </div> </a> <a aria-label="Next: tune" class="md-footer__link md-footer__link--next" href="../../tune/"> <div class="md-footer__title"> <span class="md-footer__direction"> Next </span> <div class="md-ellipsis"> tune </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright  2025  Assistance Publique - Hpitaux de Paris </div> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["navigation.tracking", "navigation.instant", "navigation.indexes", "navigation.prune", "navigation.top", "navigation.footer", "content.code.annotate", "content.code.copy", "announce.dismiss"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script> <script pret-head-scripts=""></script> </body> </html>