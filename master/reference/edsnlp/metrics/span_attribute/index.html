<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><link href="../ner/" rel="prev"/><link href="../../package/" rel="next"/><link href="../../../../assets/logo/edsnlp.svg" rel="icon"/><meta content="mkdocs-1.6.1, mkdocs-material-9.2.8" name="generator"/><title>span_attribute - EDS-NLP</title><link href="../../../../assets/stylesheets/main.046329b4.min.css" rel="stylesheet"/><link href="../../../../assets/stylesheets/palette.85d0ee34.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../../../../assets/_mkdocstrings.css" rel="stylesheet"/><link href="../../../../override.css" rel="stylesheet"/><link href="../../../../assets/stylesheets/extra.css" rel="stylesheet"/><link href="../../../../clickable-code.css" rel="stylesheet"/><link href="../../../../cards.css" rel="stylesheet"/><link href="../../../../pret.css" rel="stylesheet"/><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#edsnlpmetricsspan_attribute"> Skip to content </a> </div> <div data-md-component="announce"> <aside class="md-banner"> <div class="md-banner__inner md-grid md-typeset"> <button aria-label="Don't show this again" class="md-banner__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> Check out the new <a href="../../../../tutorials/training-span-classifier">span classifier training tutorial</a> and the <a href="../../../../tutorials/hpc">Slurm tutorial</a> ! </div> <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script> </aside> </div> <div data-md-color-scheme="default" data-md-component="outdated" hidden=""> </div> <header class="md-header md-header--shadow" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="EDS-NLP" class="md-header__button md-logo" data-md-component="logo" href="../../../.." title="EDS-NLP"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> EDS-NLP </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> span_attribute </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> </form> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a class="md-source" data-md-component="source" href="https://github.com/aphp/edsnlp" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class="md-source__repository"> aphp/edsnlp </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="EDS-NLP" class="md-nav__button md-logo" data-md-component="logo" href="../../../.." title="EDS-NLP"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg> </a> EDS-NLP </label> <div class="md-nav__source"> <a class="md-source" data-md-component="source" href="https://github.com/aphp/edsnlp" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg> </div> <div class="md-source__repository"> aphp/edsnlp </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../../.."> <span class="md-ellipsis"> Getting started </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="https://aphp.github.io/edsnlp/demo" target="_blank"> <span class="md-ellipsis"> Demo </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../tutorials/"> <span class="md-ellipsis"> Tutorials </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../pipes/"> <span class="md-ellipsis"> Pipes </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../../tokenizers/"> <span class="md-ellipsis"> Tokenizers </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../data/"> <span class="md-ellipsis"> Data Connectors </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../training/training-api/"> <span class="md-ellipsis"> Training </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../concepts/pipeline/"> <span class="md-ellipsis"> Concepts </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../metrics/"> <span class="md-ellipsis"> Metrics </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../../../utilities/"> <span class="md-ellipsis"> Utilities </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_11" type="checkbox"/> <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0"> <span class="md-ellipsis"> Code Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="true" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> Code Reference </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_11_1" type="checkbox"/> <div class="md-nav__link md-nav__container"> <a class="md-nav__link" href="../../"> <span class="md-ellipsis"> edsnlp </span> </a> <label class="md-nav__link" for="__nav_11_1"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded="true" aria-labelledby="__nav_11_1_label" class="md-nav" data-md-level="2"> <label class="md-nav__title" for="__nav_11_1"> <span class="md-nav__icon md-icon"></span> edsnlp </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../conjugator/"> <span class="md-ellipsis"> conjugator </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../connectors/"> <span class="md-ellipsis"> connectors </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../core/"> <span class="md-ellipsis"> core </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../data/"> <span class="md-ellipsis"> data </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../evaluate/"> <span class="md-ellipsis"> evaluate </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../extensions/"> <span class="md-ellipsis"> extensions </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../language/"> <span class="md-ellipsis"> language </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../matchers/"> <span class="md-ellipsis"> matchers </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_11_1_11" type="checkbox"/> <div class="md-nav__link md-nav__container"> <a class="md-nav__link" href="../"> <span class="md-ellipsis"> metrics </span> </a> <label class="md-nav__link" for="__nav_11_1_11"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav aria-expanded="true" aria-labelledby="__nav_11_1_11_label" class="md-nav" data-md-level="3"> <label class="md-nav__title" for="__nav_11_1_11"> <span class="md-nav__icon md-icon"></span> metrics </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../dep_parsing/"> <span class="md-ellipsis"> dep_parsing </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../ner/"> <span class="md-ellipsis"> ner </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> span_attribute </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../package/"> <span class="md-ellipsis"> package </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../patch_spacy/"> <span class="md-ellipsis"> patch_spacy </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../pipes/"> <span class="md-ellipsis"> pipes </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../processing/"> <span class="md-ellipsis"> processing </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../reducers/"> <span class="md-ellipsis"> reducers </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../train/"> <span class="md-ellipsis"> train </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../training/"> <span class="md-ellipsis"> training </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../tune/"> <span class="md-ellipsis"> tune </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../utils/"> <span class="md-ellipsis"> utils </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a class="md-nav__link" href="../../viz/"> <span class="md-ellipsis"> viz </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../../contributing/"> <span class="md-ellipsis"> Contributing to EDS-NLP </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../../changelog/"> <span class="md-ellipsis"> Changelog </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Table of contents" class="md-nav md-nav--secondary"> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1 id="edsnlpmetricsspan_attribute"><code>edsnlp.metrics.span_attribute</code></h1> <div class="doc doc-object doc-module"> <div class="doc doc-contents first"> <p>Metrics for Span Attribute Classification</p> <h1 id="edsnlp.metrics.span_attribute--edsnlp.metrics.span_attribute.SpanAttributeMetric">Span Attribute Classification Metrics</h1> <p>Several NLP tasks consist in classifying existing spans of text into multiple classes, such as the detection of negation, hypothesis or span linking.</p> <p>We provide a metric to evaluate the performance of such tasks,</p> <p>Let's look at an example:</p> <table> <thead> <tr> <th colspan="1" rowspan="1"> <p>pred</p> </th> <th colspan="1" rowspan="1"> <p>ref</p> </th> </tr> </thead> <tbody> <tr> <td colspan="1" rowspan="1"> <p>Le patient n'est pas <em class="chip" data-chip="SYMP neg=true">fièvreux</em>, son père a <em class="chip" data-chip="DIS carrier=PATIENT">du diabète</em>. Pas d'évolution du <em class="chip" data-chip="DIS neg=true carrier=PATIENT">cancer</em>.</p> </td> <td colspan="1" rowspan="1"> <p>Le patient n'est pas <em class="chip" data-chip="SYMP neg=true">fièvreux</em>, son père a <em class="chip" data-chip="DIS carrier=FATHER">du diabète</em>. Pas d'évolution du <em class="chip" data-chip="DIS carrier=PATIENT">cancer</em>.</p> </td> </tr> </tbody> </table> <p>We can quickly create matching documents in EDS-NLP using the following code snippet:</p> <div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">edsnlp.data.converters</span><span class="w"> </span><span class="kn">import</span> <span class="n"><html><head></head><body><a class="clickable-discrete-link" href="../../../../data/converters/#edsnlp.data.converters.MarkupToDocConverter">MarkupToDocConverter</a></body></html></span>

<span class="n">conv</span> <span class="o">=</span> <span class="n"><html><head></head><body><a class="clickable-discrete-link" href="../../../../data/converters/#edsnlp.data.converters.MarkupToDocConverter">MarkupToDocConverter</a></body></html></span><span class="p">(</span><span class="n">preset</span><span class="o">=</span><span class="s2">"md"</span><span class="p">,</span> <span class="n">span_setter</span><span class="o">=</span><span class="s2">"entities"</span><span class="p">)</span>
<span class="c1"># Create a document with predicted attributes and a reference document</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">conv</span><span class="p">(</span>
    <span class="s2">"Le patient n'est pas [fièvreux](SYMP neg=true), "</span>
    <span class="s2">"son père a [du diabète](DIS neg=false carrier=PATIENT). "</span>
    <span class="s2">"Pas d'évolution du [cancer](DIS neg=true carrier=PATIENT)."</span>
<span class="p">)</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">conv</span><span class="p">(</span>
    <span class="s2">"Le patient n'est pas [fièvreux](SYMP neg=true), "</span>
    <span class="s2">"son père a [du diabète](DIS neg=false carrier=FATHER). "</span>
    <span class="s2">"Pas d'évolution du [cancer](DIS neg=false carrier=PATIENT)."</span>
<span class="p">)</span>
</code></pre></div> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 class="doc doc-heading" id="edsnlp.metrics.span_attribute.SpanAttributeMetric"> <code class="highlight language-python"><span class="n">SpanAttributeMetric</span></code> </h2> <div class="doc doc-contents"> <p>The <code>eds.span_attribute</code> metric evaluates span‐level attribute classification by comparing predicted and gold attribute values on the same set of spans. For each attribute you specify, it computes Precision, Recall, F1, number of true positives (tp), number of gold instances (support), number of predicted instances (positives), and the Average Precision (ap). A micro‐average over all attributes is also provided under <code>micro_key</code>.</p> <div class="no-check highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">edsnlp.metrics.span_attribute</span><span class="w"> </span><span class="kn">import</span> <span class="n"><html><head></head><body><a class="clickable-discrete-link" href="../../../../metrics/span-attribute/#edsnlp.metrics.span_attribute.SpanAttributeMetric">SpanAttributeMetric</a></body></html></span>

<span class="n">metric</span> <span class="o">=</span> <span class="n"><html><head></head><body><a class="clickable-discrete-link" href="../../../../metrics/span-attribute/#edsnlp.metrics.span_attribute.SpanAttributeMetric">SpanAttributeMetric</a></body></html></span><span class="p">(</span>
    <span class="n">span_getter</span><span class="o">=</span><span class="n">conv</span><span class="o">.</span><span class="n">span_setter</span><span class="p">,</span>
    <span class="c1"># Evaluated attributes</span>
    <span class="n">attributes</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">"neg"</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># 'neg' on every entity</span>
        <span class="s2">"carrier"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"DIS"</span><span class="p">],</span>  <span class="c1"># 'carrier' only on 'DIS' entities</span>
    <span class="p">},</span>
    <span class="c1"># Ignore these default values when counting matches</span>
    <span class="n">default_values</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">"neg"</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">micro_key</span><span class="o">=</span><span class="s2">"micro"</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div> <p>Let's enumerate (span -&gt; attr = value) items in our documents. Only the items with matching span boundaries, attribute name, and value are counted as a true positives. For instance, with the predicted and reference spans of the example above:</p> <table> <thead> <tr> <th colspan="1" rowspan="1"> <p>pred</p> </th> <th colspan="1" rowspan="1"> <p>ref</p> </th> </tr> </thead> <tbody> <tr> <td colspan="1" rowspan="1"> <p><em class="chip tp">fièvreux → neg = True</em><br/> <em class="chip na">du diabète → neg = False</em><br/> <em class="chip fp">du diabète → carrier = PATIENT</em><br/> <em class="chip fp">cancer → neg = True</em><br/> <em class="chip tp">cancer → carrier = PATIENT</em></p> </td> <td colspan="1" rowspan="1"> <p><em class="chip tp">fièvreux → neg = True</em><br/> <em class="chip na">du diabète → neg = False</em><br/> <em class="chip fn">du diabète → carrier = FATHER</em><br/> <em class="chip na">cancer → neg = False</em><br/> <em class="chip tp">cancer → carrier = PATIENT</em></p> </td> </tr> </tbody> </table> <div class="admonition note"> <p class="admonition-title">Default values</p> <p>Note that there we don't count "neg=False" items, shown in grey in the table. In EDS-NLP, this is done by setting <code>defaults_values={"neg": False}</code> when creating the metric. This is quite common in classification tasks, where one of the values is both the most common and the "default" (hence the name of the parameter). Counting these values would likely skew the micro-average metrics towards the default value.</p> </div> <p>Precision, Recall and F1 (micro-average and per‐label) are computed as follows:</p> <ul> <li>Precision: <code>p = |matched items of pred| / |pred|</code></li> <li>Recall: <code>r = |matched items of ref| / |ref|</code></li> <li>F1: <code>f = 2 / (1/p + 1/f)</code></li> </ul> <p>This yields the following metrics:</p> <div class="highlight"><pre><span></span><code><span class="n">metric</span><span class="p">([</span><span class="n">ref</span><span class="p">],</span> <span class="p">[</span><span class="n">pred</span><span class="p">])</span>
<span class="c1"># Out: {</span>
<span class="c1">#   'micro': {'f': 0.57, 'p': 0.5, 'r': 0.67, 'tp': 2, 'support': 3, 'positives': 4, 'ap': 0.17},</span>
<span class="c1">#   'neg': {'f': 0.67, 'p': 0.5, 'r': 1, 'tp': 1, 'support': 1, 'positives': 2, 'ap': 0.0},</span>
<span class="c1">#   'carrier': {'f': 0.5, 'p': 0.5, 'r': 0.5, 'tp': 1, 'support': 2, 'positives': 2, 'ap': 0.25},</span>
<span class="c1"># }</span>
</code></pre></div> <h3 id="edsnlp.metrics.span_attribute.SpanAttributeMetric--parameters">Parameters</h3> <table> <thead> <tr> <th><b>PARAMETER</b></th> <th><b>DESCRIPTION</b></th> </tr> </thead> <tbody> <tr> <td><code>span_getter</code></td> <td class="doc-param-details"> <p>The span getter to extract spans from each <code>Doc</code>.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-internal" href="../../utils/span_getters/#edsnlp.utils.span_getters.SpanGetterArg" title="SpanGetterArg (edsnlp.utils.span_getters.SpanGetterArg)">SpanGetterArg</a></code> </span> </p> </td> </tr> <tr> <td><code>attributes</code></td> <td class="doc-param-details"> <p>Map each attribute name to <code>True</code> (evaluate on all spans) or a sequence of labels restricting which spans to test.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="Mapping">Mapping</span>[<span title="str">str</span>, <span title="typing.Union">Union</span>[<span title="bool">bool</span>, <span title="Sequence">Sequence</span>[<span title="str">str</span>]]]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr> <td><code>default_values</code></td> <td class="doc-param-details"> <p>Attribute values to omit from micro‐average counts (e.g., common negative or default labels).</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> <tr> <td><code>include_falsy</code></td> <td class="doc-param-details"> <p>If <code>False</code>, ignore falsy values (e.g., <code>False</code>, <code>None</code>, <code>''</code>) in predictions or gold when computing metrics; if <code>True</code>, count them.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="bool">bool</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr> <td><code>micro_key</code></td> <td class="doc-param-details"> <p>Key under which to store the micro‐averaged results across all attributes.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="str">str</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'micro'</code> </span> </p> </td> </tr> <tr> <td><code>filter_expr</code></td> <td class="doc-param-details"> <p>A Python expression (using <code>doc</code>) to filter which examples are scored.</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class="doc-section-title">RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <span class="doc-returns-annotation"> <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="float">float</span>]]</code> </span> </td> <td class="doc-returns-details"> <div class="doc-md-description"> <p>A dictionary mapping each attribute name (and the <code>micro_key</code>) to its metrics:</p> <ul> <li> <p><code>label</code> or micro_key :</p> <ul> <li><code>p</code> : precision</li> <li><code>r</code> : recall</li> <li><code>f</code> : F1 score</li> <li><code>tp</code> : true positive count</li> <li><code>support</code> : number of gold instances</li> <li><code>positives</code> : number of predicted instances</li> <li><code>ap</code> : <a href="https://en.wikipedia.org/wiki/Evaluation_measures_(information_retrieval)#Mean_average_precision">average precision</a></li> </ul> </li> </ul> </div> </td> </tr> </tbody> </table> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 class="doc doc-heading" id="edsnlp.metrics.span_attribute.SpanAttributeMetric.__call__"> <code class="highlight language-python"><span class="fm">__call__</span></code> </h3> <div class="doc doc-contents"> <p>Compute the span attribute metrics for the given examples.</p> <h4 id="edsnlp.metrics.span_attribute.SpanAttributeMetric.__call__--parameters">Parameters</h4> <table> <thead> <tr> <th><b>PARAMETER</b></th> <th><b>DESCRIPTION</b></th> </tr> </thead> <tbody> <tr> <td><code>examples</code></td> <td class="doc-param-details"> <p>The examples to score, either a tuple of (golds, preds) or a list of spacy.training.Example objects</p> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="edsnlp.metrics.Examples">Examples</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>()</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class="doc-section-title">RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <span class="doc-returns-annotation"> <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="typing.Dict">Dict</span>[<span title="str">str</span>, <span title="float">float</span>]]</code> </span> </td> <td class="doc-returns-details"> <div class="doc-md-description"> <p>The scores for the attributes</p> </div> </td> </tr> </tbody> </table> </div> </div> </div> </div> </div> </div> </div> </div> <div class="footnote"><hr/><ol></ol></div> </article> </div> </div> <button class="md-top md-icon" data-md-component="top" hidden="" type="button"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> Back to top </button> </main> <footer class="md-footer"> <nav aria-label="Footer" class="md-footer__inner md-grid"> <a aria-label="Previous: ner" class="md-footer__link md-footer__link--prev" href="../ner/" rel="prev"> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </div> <div class="md-footer__title"> <span class="md-footer__direction"> Previous </span> <div class="md-ellipsis"> ner </div> </div> </a> <a aria-label="Next: package" class="md-footer__link md-footer__link--next" href="../../package/" rel="next"> <div class="md-footer__title"> <span class="md-footer__direction"> Next </span> <div class="md-ellipsis"> package </div> </div> <div class="md-footer__button md-icon"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright © 2025 – Assistance Publique - Hôpitaux de Paris </div> Made with <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tracking", "navigation.instant", "navigation.indexes", "navigation.prune", "navigation.top", "navigation.footer", "content.code.annotate", "content.code.copy", "announce.dismiss"], "search": "../../../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src="../../../../assets/javascripts/bundle.dff1b7c8.min.js"></script> <script pret-head-scripts=""></script> </body> </html>